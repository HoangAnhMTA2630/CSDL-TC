{
  "gitSyncId": "682d4d2a92cca105dbc17693_0f28f7d9-37f8-4ebf-bae9-62d3aa8dd7ee",
  "id": "Trinh sát - Tấn công_DSChiTietMucTieu",
  "pluginId": "postgres-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "body": "SELECT \n    mt.id AS muc_tieu_id,\n    mt.domain,\n    mt.email,\n    \n    -- Subdomains\n    STRING_AGG(DISTINCT sd.subdomain, ', ') AS subdomains,\n\n    -- Cổng dịch vụ\n    STRING_AGG(DISTINCT CONCAT(cmdv.cong, ' (', cmdv.dich_vu, ')'), ', ') AS cong_dich_vu,\n\n\n\n    -- Đường dẫn ẩn\n    STRING_AGG(DISTINCT dda.ten_duong_dan_an, ', ') AS duong_dan_an,\n\n    -- Lỗ hổng bảo mật\n    STRING_AGG(DISTINCT lhb.ten_lo_hong, ', ') AS lo_hong_bao_mat\n\nFROM \n    public.muc_tieu mt\n\n-- Subdomain\nLEFT JOIN public.subdomain sd ON sd.muc_tieu_id = mt.id\n\n-- Cổng mở dịch vụ\nLEFT JOIN public.muc_tieu_cong_mo_dich_vu mtcmdv ON mtcmdv.muc_tieu_id = mt.id\nLEFT JOIN public.cong_mo_dich_vu cmdv ON cmdv.id = mtcmdv.cong_mo_dich_vu_id\n\n-- Công nghệ\n\n\n-- Đường dẫn ẩn\nLEFT JOIN public.muc_tieu_duong_dan_an mtdda ON mtdda.muc_tieu_id = mt.id\nLEFT JOIN public.duong_dan_an dda ON dda.id = mtdda.duong_dan_an_id\n\n-- Lỗ hổng bảo mật\nLEFT JOIN public.muc_tieu_lo_hong_bao_mat_web mtlh ON mtlh.muc_tieu_id = mt.id\nLEFT JOIN public.lo_hong_bao_mat_web lhb ON lhb.id = mtlh.lo_hong_bao_mat_web_id\n\nWHERE \n    mt.id = {{Table.triggeredRow.id}}\n\nGROUP BY \n    mt.id, mt.domain, mt.email;\n",
      "encodeParamsToggle": true,
      "paginationType": "NONE",
      "pluginSpecifiedTemplates": [
        {
          "value": false
        }
      ],
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "csdltc",
      "isAutoGenerated": false,
      "name": "csdltc",
      "pluginId": "postgres-plugin"
    },
    "dynamicBindingPathList": [
      {
        "key": "body"
      }
    ],
    "executeOnLoad": true,
    "name": "DSChiTietMucTieu",
    "pageId": "Trinh sát - Tấn công",
    "userSetOnLoad": false
  }
}